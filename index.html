<!DOCTYPE html>
<html lang="ko">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">
  <title>ë¦¬ë“¬ê²Œì„</title>
  <style>
  :root { --max-width: 900px; }

  * { box-sizing: border-box; }

  html, body {
    margin: 0;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
    -webkit-text-size-adjust: 100%;
  }

  body {
    display: flex; flex-direction: column; align-items: center;
    padding: 16px;
    background: #fff;
  }

  /* âœ… íƒ€ì´í‹€ í¬ê²Œ: ëª¨ë°”ì¼ì—ì„œë„ í™•ì‹¤íˆ ë³´ì´ê²Œ */
  h1 {
    margin: 12px 0 10px;
    line-height: 1.2;
    font-weight: 800;
    font-size: clamp(24px, 7vw, 40px);
    letter-spacing: -0.02em;
  }

  /* ë²„íŠ¼/ì…ë ¥ì°½ ì»¨í…Œì´ë„ˆ */
  .bar { width: 100%; max-width: var(--max-width); display:flex; justify-content:center; gap:12px; flex-wrap: wrap; margin-bottom: 12px; }

  /* âœ… ë²„íŠ¼ í¬ê²Œ + í„°ì¹˜ íƒ€ê¹ƒ í™•ë³´(ìµœì†Œ 44px ë†’ì´) */
  button {
    font-size: clamp(16px, 4.5vw, 18px);
    padding: 14px 18px;
    min-height: 48px;
    border-radius: 12px;
    border: 1px solid #d0d0d0;
    background:#ffffff;
    box-shadow: 0 1px 0 rgba(0,0,0,0.06);
  }

  button:active { transform: translateY(1px); }

  /* ì»¨í…ì¸  í­ */
  #content { width: 100%; max-width: var(--max-width); }

  /* âœ… ì…ë ¥ì°½ í¬ê²Œ */
  .input-row { display:flex; align-items:center; justify-content:center; gap:10px; margin: 10px 0; }
  label { font-size: clamp(15px, 4.2vw, 17px); }
  input[type="text"] {
    font-size: clamp(16px, 4.8vw, 18px);
    padding: 12px 14px;
    min-height: 48px;
    width: min(420px, 80vw);
    border: 1.2px solid #cfcfcf;
    border-radius: 10px;
    background: #fff;
  }

  /* ë³¸ë¬¸ í…ìŠ¤íŠ¸ */
  p { margin: 10px 0; font-size: clamp(15px, 4.2vw, 17px); text-align:center; }

  /* ìº”ë²„ìŠ¤ëŠ” ê·¸ëŒ€ë¡œ ë°˜ì‘í˜• (ì´ì „ ë‹¨ê³„ ìœ ì§€) */
  canvas {
    width: 100%;
    max-height: 70vh; /* ëª¨ë°”ì¼ ìƒí•œ */
    display: block; margin: 0 auto; border: 1px solid #000;
    touch-action: manipulation;
  }

  /* ë°ìŠ¤í¬íƒ‘ì—ì„œ ì‚´ì§ ì¤„ì´ê¸° */
  @media (min-width: 1024px) {
    button { padding: 12px 16px; }
    input[type="text"] { width: 420px; }
  }
</style>


</head>
<body>
  <h1>ğŸµ ë¦¬ë“¬ê²Œì„ ğŸµ</h1>
  <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
  <button onclick="showRanking()">ë­í‚¹ í™•ì¸</button>

  <div id="content"></div>

<script>
  // ====== ì „ì—­ ìƒíƒœ ======
  let gameArea, ctx;
  let score = 0;
  let circles = [];
  let gameInterval;

  // ë…¼ë¦¬ ì¢Œí‘œ(ë””ìì¸ í•´ìƒë„)
  const DESIGN_W = 600;
  const DESIGN_H = 400;

  // íŒì • ìƒìˆ˜
  const TARGET = 70;
  const PERFECT_MIN = 60;
  const PERFECT_MAX = 80;

  // í„°ì¹˜ íˆíŠ¸ë°•ìŠ¤ (ë…¼ë¦¬ ì¢Œí‘œ ê¸°ì¤€)
  const TOUCH_CENTER_X = 300;
  const TOUCH_CENTER_Y = 200;
  const TOUCH_HIT_RADIUS = 65; // ìš”ì²­ê°’

  // ë·°(ìŠ¤ì¼€ì¼ ìƒíƒœ)
  const view = {
    cssW: 0, cssH: 0,
    dpr: 1,
    scale: 1,
    offsetX: 0, offsetY: 0
  };

  // ====== ë¦¬ì‚¬ì´ì¦ˆ & ìŠ¤ì¼€ì¼ë§ ======
  function resizeCanvas() {
    if (!gameArea || !ctx) return;

    const container = gameArea.parentElement;
    const containerW = container.clientWidth;

    const aspect = DESIGN_H / DESIGN_W; // 400/600
    let cssW = containerW;
    let cssH = Math.round(cssW * aspect);

    const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
    const maxH = (window.innerWidth < 768) ? Math.round(vh * 0.70) : Math.round(vh * 0.60);
    if (cssH > maxH) {
      cssH = maxH;
      cssW = Math.round(cssH / aspect);
    }

    view.cssW = cssW;
    view.cssH = cssH;

    const dpr = window.devicePixelRatio || 1;
    view.dpr = dpr;
    gameArea.style.width = cssW + "px";
    gameArea.style.height = cssH + "px";
    gameArea.width = Math.round(cssW * dpr);
    gameArea.height = Math.round(cssH * dpr);

    const scaleX = cssW / DESIGN_W;
    const scaleY = cssH / DESIGN_H;
    view.scale = Math.min(scaleX, scaleY);
    view.offsetX = (cssW - DESIGN_W * view.scale) / 2;
    view.offsetY = (cssH - DESIGN_H * view.scale) / 2;

    applyViewTransform();
  }

  function applyViewTransform() {
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.setTransform(view.scale * view.dpr, 0, 0, view.scale * view.dpr,
                     view.offsetX * view.dpr, view.offsetY * view.dpr);
  }

  function clearFrame() {
    ctx.save();
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.clearRect(0, 0, gameArea.width, gameArea.height);
    ctx.restore();
    applyViewTransform();
  }

  // ====== ê³µìš© íŒì • ì²˜ë¦¬ ======
  function attemptHit() {
    if (circles.length === 0) return;
    const c = circles[0];
    const r = c.radius;
    let gained = 0;

    if (r > PERFECT_MIN && r < PERFECT_MAX) {
      gained = 100; // 60 < r < 80
    } else if (Math.abs(r - TARGET) < 25) {
      gained = 50;  // íƒ€ê²Ÿ Â±25
    } else {
      gained = 10;
    }

    score += gained;
    document.getElementById("score").innerText = score;
    circles.shift(); // ì‚¬ìš©í•œ ì› ì œê±°
  }

  // ====== ì…ë ¥: í‚¤ë³´ë“œ(PC í…ŒìŠ¤íŠ¸ìš©) ======
  function onKeyDown(e) {
    if (e.code !== "Space") return;
    attemptHit(); // í‚¤ë³´ë“œëŠ” íˆíŠ¸ë°•ìŠ¤ ì œí•œ ì—†ìŒ (ìš”ì²­ëŒ€ë¡œ ìœ ì§€)
  }

  // ====== ì…ë ¥: í„°ì¹˜/í´ë¦­(ëª¨ë°”ì¼ ìš°ì„ ) ======
  function screenToLogical(clientX, clientY) {
    const rect = gameArea.getBoundingClientRect();
    const cssX = clientX - rect.left;
    const cssY = clientY - rect.top;
    // CSS í”½ì…€ â†’ ë…¼ë¦¬ ì¢Œí‘œ (ì˜¤í”„ì…‹/ìŠ¤ì¼€ì¼ ë°˜ì˜, DPRì€ ì´ë¯¸ CSS ì¢Œí‘œë¡œ ë“¤ì–´ì˜´)
    const x = (cssX - view.offsetX) / view.scale;
    const y = (cssY - view.offsetY) / view.scale;
    return { x, y };
  }

  function onPointerDown(e) {
    // í•œ ì†ê°€ë½ë§Œ íŒì •
    const { x, y } = screenToLogical(e.clientX, e.clientY);
    const dx = x - TOUCH_CENTER_X;
    const dy = y - TOUCH_CENTER_Y;
    const dist = Math.hypot(dx, dy);

    // íˆíŠ¸ë°•ìŠ¤: ì¤‘ì‹¬ì—ì„œ r â‰¤ 65 ì•ˆìª½ì¼ ë•Œë§Œ íŒì • ì‹œë„
    if (dist <= TOUCH_HIT_RADIUS) {
      attemptHit();
    }
  }

  // ====== ê²Œì„ ë£¨í”„ ======
  function updateGame() {
    clearFrame();

    const lw = 1 / view.scale;
    ctx.lineWidth = lw;
    ctx.font = `${Math.max(10, Math.floor(12 / view.scale))}px sans-serif`;

    // ì› ì—…ë°ì´íŠ¸ & ê·¸ë¦¬ê¸°
    circles.forEach(c => {
      c.radius += 1; // ì†ë„ ê·¸ëŒ€ë¡œ
      ctx.beginPath();
      ctx.setLineDash([]);
      ctx.strokeStyle = "black";
      ctx.arc(c.x, c.y, c.radius, 0, Math.PI * 2);
      ctx.stroke();
      ctx.fillText("r=" + Math.floor(c.radius), c.x + c.radius + 6, c.y);
    });

    // í¼í™íŠ¸ ë²”ìœ„(ì´ˆë¡ ì ì„ )
    ctx.setLineDash([6 / view.scale, 6 / view.scale]);
    ctx.strokeStyle = "green";
    ctx.beginPath();
    ctx.arc(300, 200, PERFECT_MIN, 0, Math.PI * 2);
    ctx.stroke();
    ctx.beginPath();
    ctx.arc(300, 200, PERFECT_MAX, 0, Math.PI * 2);
    ctx.stroke();

    // íƒ€ê¹ƒ(ë¹¨ê°„ ì ì„ )
    ctx.setLineDash([10 / view.scale, 7 / view.scale]);
    ctx.strokeStyle = "red";
    ctx.beginPath();
    ctx.arc(300, 200, TARGET, 0, Math.PI * 2);
    ctx.stroke();

    requestAnimationFrame(updateGame);
  }

  // ====== í™”ë©´ êµ¬ì„± ======
  function startGame() {
  document.getElementById("content").innerHTML = `
    <div class="input-row">
      <label for="studentId">í•™ë²ˆ</label>
      <input id="studentId" type="text" placeholder="ì˜ˆ) 30123">
    </div>
    <div class="input-row">
      <label for="name">ì´ë¦„</label>
      <input id="name" type="text" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
    </div>
    <div class="bar">
      <button onclick="gameStart()">ì…ë ¥ ì™„ë£Œ</button>
    </div>
  `;
}


  function gameStart() {
    const id = (document.getElementById("studentId").value || "").trim();
    const name = (document.getElementById("name").value || "").trim();

    document.getElementById("content").innerHTML = `
      <canvas id="gameCanvas"></canvas>
      <p>ì ìˆ˜: <span id="score">0</span></p>
      <p>${id} ${name} ë‹˜, ìŒì•…ì— ë§ì¶° í™”ë©´ ì¤‘ì•™ì—ì„œ í„°ì¹˜ ë˜ëŠ” ìŠ¤í˜ì´ìŠ¤ë°”! (ëª¨ë°”ì¼: í„°ì¹˜, PC: Space)</p>
    `;

    gameArea = document.getElementById("gameCanvas");
    ctx = gameArea.getContext("2d");

    gameInterval = setInterval(createCircle, 2000);
    resizeCanvas();
    requestAnimationFrame(updateGame);

    // ì…ë ¥ ë“±ë¡
    document.addEventListener("keydown", onKeyDown, { passive: true });
    gameArea.addEventListener("pointerdown", onPointerDown, { passive: true });

    // ë°˜ì‘í˜•
    window.addEventListener("resize", resizeCanvas);
    window.addEventListener("orientationchange", () => setTimeout(resizeCanvas, 50));
  }

  // ====== ë°ì´í„° ======
  function createCircle() {
    circles.push({ x: 300, y: 200, radius: 10 });
  }

  function showRanking() {
    document.getElementById("content").innerHTML = `<p>ë­í‚¹ ê¸°ëŠ¥ì€ ì¶”í›„ ì¶”ê°€ ì˜ˆì •</p>`;
  }
</script>



</body>
</html>




